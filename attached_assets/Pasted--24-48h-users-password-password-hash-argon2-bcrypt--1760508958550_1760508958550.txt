즉시(24–48h) 고쳐야 할 것
보안/안정성

비밀번호 저장: users.password를 평문으로 두면 안 됩니다 → password_hash(argon2/bcrypt)로 교체, salt는 라이브러리가 처리.

/api/go 오픈 리다이렉트: 현재 임의 URL로 리다이렉트 가능 → allowlist(coupang/naver/제휴네트워크 도메인)로 제한 + 유효성 검증.

API 키 노출 방지: 클라 번들에 키가 남지 않게(네이버/Gemini/Stripe/아임포트는 서버 전용).

레이트리밋/헬멧: helmet + express-rate-limit 기본값 적용(이미 적용 계획 있음 → 서버에 확실히 연결).

로깅/PII 최소화: affiliate_clicks에 IP 저장 금지(필요 시 지역 추론은 서버측에서 익명화), UA/리퍼러만.

데이터 스키마/인덱스

users: email UNIQUE, created_at, last_login_at, status(active/blocked), country/lang(i18n 대비).

affiliate_clicks: clicked_at DEFAULT now(), sub_id, campaign, country(파생), 인덱스((clicked_at), (platform, clicked_at)).

검색 로그 테이블 추가: search_logs(id, user_id, product_name, local_currency, local_price, krw_price, created_at).

법/정책(스토어·제휴)

제휴 고지 상시 노출: 결과 카드/구매 버튼 인근 + 설정/푸터.

가격 면책 문구: “실시간 변동 가능, 동일 모델/옵션 기준 비교”.

개인정보 처리방침/이용약관 링크: 모든 화면에서 1~2탭 내 접근 가능(푸터/설정).

🚀 출시 전(1주) 체크
기능/UX

소프트/하드월 서버 검증: 클라 localStorage만으로 우회 가능 → 서버 세션/토큰 기반 추가 검증.

에러 UX: 네트워크/타임아웃/빈결과 각각 다른 메시지 + 재시도 버튼.

PWA 품질: manifest 아이콘/명칭/스플래시, SW 캐시 정책(버전/만료) 점검, 오프라인 안내.

성능/비용

캐시: 환율(5분), 네이버 검색(3분) 캐시 적용.

이미지 처리: 업로드 제한(용량/해상도), 모바일에서 리사이즈 후 전송.

Lighthouse 목표: LCP < 2.5s, CLS < 0.1, JS < 300–500KB(초기).

관측/테스트

Sentry + LogRocket: 프런트 런타임 에러 및 세션 리플레이.

Playwright 스모크(4종: /healthz, convert, compare, /go) + Checkly 모니터링.

testRigor 시나리오: “촬영→비교→제휴” 사용자 플로우를 자연어로 자동화.

결제/정책(스토어 대비)

환불/해지 정책 문서화(약관/FAQ).

Apple/Google 심사용: 카메라 목적 문구, 데이터 삭제/계정 삭제 경로(앱 내 링크 또는 웹 폼), 서드파티 공유 고지.

📈 출시 후(30일) 로드맵
수익/제휴

쿠팡 파트너스: 먼저 신청/승인 → 링크빌더 기본 URL + subId 동적 부여(사용자/세션/국가).

네이버 제휴: 링크프라이스/애드픽 등 네트워크 경유 캠페인 승인 → 네이버 상품 클릭 시 해당 캠페인 링크로 변환.

/search/unified: 네이버 + (초기 쿠팡 Mock) → API 승인 후 쿠팡 실제 검색으로 교체, 최저가 정렬.

대시보드/분석

운영용 대시보드: 지난 7/30일 검색수·클릭수·추정 절약액, 플랫폼별 CTR, 상위 상품.

A/B 테스트: (1) 쿠팡/네이버 노출 순서, (2) 버튼 문구, (3) 추천 배지 유무.

확장/국제화

Home Country 설정: 통화/언어/쇼핑몰 소스 스위칭(한국→중국/일본/태국 순).

중국 대비: 기능은 글로벌서버에서 동작, 배포는 현지 파트너 통해(스토어/결제/ICP).

🔐 위험 포인트 & 해결책(핵심만)

오픈 리다이렉트(/api/go) → 도메인 allowlist + URL 검증 + 로그.

비밀번호 평문 → password_hash로 변경(bcrypt/argon2), 로그인 실패 레이트리밋.

API 키 노출 → 전부 서버 환경변수에서만 사용, 응답/클라에 절대 포함 금지.

과도한 로그/PII → 최소 수집, 보관 기간 명시·파기 자동화.

API 실패 → axios-retry(지수 백오프)+백업 환율 API 필수.

소프트월 우회 → 서버 검증 추가(세션/토큰, misuse 차단).

🧩 문서 자체 보완(사소하지만 중요)

번호 중복/오타: 섹션 7.3이 두 번 나옵니다(“알려진 이슈/배포 준비”). “9. 검토 요청” 하위 제목이 “9.1/9.2/9.3”으로 되어 있으니 “10.1/10.2/10.3”로 정리.

데이터 보존/삭제: 보존 기간(예: 클릭 로그 12개월), 파기 정책 명시.

계정 삭제/데이터 삭제 요청 경로: 심사 대응용으로 필수(앱 내 링크/이메일).

가격/환율 면책: “가격/환율은 실시간 변동, 고시 목적 아님” 한 줄 추가.

📜 바로 적용하는 스니펫(요약)

리다이렉트 도메인 화이트리스트

const ALLOW = ["link.coupang.com","smartstore.naver.com","shopping.naver.com","redir.linkprice.com"]; // 예시
function safeRedirect(urlStr:string) {
  const u = new URL(urlStr);
  if (!ALLOW.includes(u.hostname)) throw new Error("DISALLOWED_DOMAIN");
  return u.toString();
}


bcrypt 해시

import bcrypt from "bcryptjs";
const hash = await bcrypt.hash(plainPassword, 12);
const ok = await bcrypt.compare(input, hash);


axios 재시도 + 백업 환율(이미 설계하신 것 유지)

✅ 최종 한 줄 요약

기획·기능 방향 매우 좋습니다. 보안(비번/리다이렉트/키), 서버 검증(소프트월), 관측(Sentry/테스트) 3가지만 지금 묶어서 보완하면, 심사·운영 모두 안정적으로 갈 수 있어요.

문서/코드 패치가 필요하면 해당 파일 경로와 함께 요청 주세요. 라인 단위로 바로 반영해 드릴게요.